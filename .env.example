# ========================================
# Obsidian LiveSync Server Configuration
# ========================================
# Copy this file to .env and fill in your values
# Run: cp .env.example .env

# ----- Domain & Public URL -----
# Your domain name (required for SSL)
DOMAIN=obsidian.example.com

# Public URL where clients will connect
# Include https:// and your domain
PUBLIC_URL=https://obsidian.example.com

# Email for Let's Encrypt SSL certificates
SSL_EMAIL=admin@example.com

# SSL method: letsencrypt, traefik, manual, or none
# - letsencrypt: Automatic SSL with certbot
# - traefik: Automatic SSL with Traefik reverse proxy
# - manual: Provide your own certificates
# - none: HTTP only (not recommended for production)
SSL_METHOD=letsencrypt

# ----- CouchDB Admin Credentials -----
# Main admin user for CouchDB
COUCHDB_USER=admin
COUCHDB_PASSWORD=                # Auto-generated if empty

# CouchDB secret for cookie authentication
COUCHDB_SECRET=                  # Auto-generated if empty

# ----- CouchDB Sync User -----
# User that Obsidian clients authenticate as (via auth proxy)
SYNC_USER=obsidian
SYNC_PASSWORD=                   # Auto-generated if empty

# ----- Database Configuration -----
# Database name for your Obsidian vault
DB_NAME=obsidian-sync

# ----- JWT Authentication -----
# Secret for signing JWT tokens (auto-generated if empty)
JWT_HMAC_SECRET=

# Admin token for managing device tokens via API
ADMIN_TOKEN=                     # Auto-generated if empty

# ----- Network Configuration -----
# External ports (what users connect to)
HTTP_PORT=80
HTTPS_PORT=443

# Internal ports (Docker services, not exposed)
COUCHDB_HOST=couchdb             # Docker service name
COUCHDB_PORT=5984

AUTH_PROXY_HOST=0.0.0.0          # Bind to all interfaces inside container
AUTH_PROXY_PORT=5985

# ----- Data Paths (Docker Volumes) -----
# These are paths inside the containers
DATA_DIR=/app/data               # CouchDB data directory
BACKUP_DIR=/app/backups          # Backup storage
TOKEN_DB_PATH=/app/tokens/tokens.db  # SQLite database for device tokens

# ----- Auth Proxy Settings -----
# Number of worker processes for auth proxy
AUTH_PROXY_WORKERS=2

# Log level: debug, info, warning, error
LOG_LEVEL=info

# ----- Timezone -----
TZ=UTC

# ----- Advanced CouchDB Settings -----
# Maximum document size (in bytes)
# Default: 52428800 (50 MB)
COUCHDB_MAX_DOCUMENT_SIZE=52428800

# Maximum HTTP request size (in bytes)
COUCHDB_MAX_HTTP_REQUEST_SIZE=52428800

# ----- Backup Configuration -----
# Number of daily backups to keep
MAX_BACKUPS=14

# Backup schedule (cron format)
# Default: Daily at 2 AM
BACKUP_SCHEDULE=0 2 * * *
